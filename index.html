<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Department Of Justice</title>
  <link rel="icon" href="logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    :root{--bg:#0b0f14;--panel:#111823;--soft:#16202d;--ink:#eaf2ff;--muted:#b7c3d9;--accent:#6aa7ff;--danger:#ff5d5d;--ok:#35d07f;}
    body{margin:0;font-family:Inter,system-ui;background:var(--bg);color:var(--ink);}
    .wrap{max-width:980px;margin:28px auto;padding:22px;}

    /* Header */
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;}
    .nav-left{display:flex;align-items:center;gap:10px;}
    .nav-left img{height:36px;width:36px;}
    h1{text-transform:uppercase;font-size:clamp(20px,3.6vw,28px);margin:0;}
    .nav-right button{background:linear-gradient(180deg,var(--muted),#5a6578);color:#fff;border:none;border-radius:10px;padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:6px;}

    /* Search */
    .search-section{margin-bottom:24px;text-align:center;}
    .search-label{display:block;margin-bottom:10px;font-size:15px;color:var(--muted);font-weight:bold;}
    .search-container{position:relative;margin:0 auto;width:100%;max-width:800px;padding:0 12px;box-sizing:border-box;}
    .search-container input{width:100%;padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,.06);background:var(--soft);color:var(--ink);outline:none;font-size:16px;box-sizing:border-box;}
    .search-container input:focus{box-shadow:0 0 0 4px rgba(106,167,255,.14);}
    .suggestions{position:absolute;top:100%;left:12px;right:12px;background:var(--panel);border-radius:12px;margin-top:6px;max-height:220px;overflow-y:auto;box-shadow:0 12px 30px rgba(0,0,0,.4);opacity:0;pointer-events:none;transform:translateY(6px);transition:opacity .25s,transform .25s;}
    .suggestions.show{opacity:1;pointer-events:auto;transform:translateY(0);}
    .suggestion-item{padding:10px 14px;cursor:pointer;font-size:15px;}
    .suggestion-item:hover{background:var(--soft);}

    /* Categories */
    .category{margin-bottom:28px;}
    .category h2{margin-bottom:12px;font-size:18px;font-weight:800;text-transform:uppercase;}
    
    /* Cards */
    .card{background:var(--panel);border:1px solid rgba(255,255,255,.05);border-radius:16px;padding:18px;box-shadow:0 8px 24px rgba(0,0,0,.3);margin-bottom:16px;}
    .card h3{margin:0 0 8px;font-size:16px;font-weight:700;}
    .card p{margin:0 0 12px;color:var(--muted);font-size:13px;}
    .actions{display:flex;gap:12px;flex-wrap:wrap;}
    button{cursor:pointer;font-weight:700;border:none;border-radius:12px;padding:10px 16px;display:flex;align-items:center;gap:8px;transition:transform .2s;}
    button:hover{transform:scale(1.05);}
    .btn-primary{background:linear-gradient(180deg,var(--accent),#3556c7);color:#fff;}
    .btn-share{background:linear-gradient(180deg,var(--ok),#218c57);color:#fff;}

    /* PDF View */
    .pdf-view{width:100%;height:calc(100vh - 70px);}
    .pdf-view iframe,.pdf-view embed{width:100%;height:100%;border:none;overflow:auto;}

    /* Notifications */
    .notifications{position:fixed;top:20px;right:20px;z-index:10000;display:flex;flex-direction:column;gap:10px;}
    .notif{padding:10px 14px;border-radius:10px;background:var(--panel);font-size:13px;opacity:0;transform:translateY(-10px);transition:opacity .3s,transform .3s;}
    .notif.show{opacity:1;transform:translateY(0);}
    .notif.hide{opacity:0;transform:translateY(-10px);}
  </style>
</head>
<body>
  <div class="wrap" id="content-container">
    <header>
      <div class="nav-left">
        <img src="logo.png" alt="Logo">
        <h1 id="page-title">Department Of Justice</h1>
      </div>
      <div class="nav-right" id="nav-right"></div>
    </header>

    <!-- Recherche -->
    <div class="search-section" id="search-section">
      <label for="search" class="search-label">Rechercher un document :</label>
      <div class="search-container">
        <input type="text" id="search" placeholder="Tapez pour rechercher...">
        <div class="suggestions" id="suggestions"></div>
      </div>
    </div>

    <!-- Liste des documents -->
    <div id="list-view"></div>
  </div>

  <div class="notifications" id="notifications"></div>

  <script>
    lucide.createIcons();

    const documentsData = {
      "RAPPORTS D'INTERVENTION": [
        { title: 'RAPPORT INTERVENTION DPO_19082025_1', date: '19/08/2025', pdfUrl: 'Rapport190820251.pdf' }
      ],
      "AUDIENCES": [
        { title: 'AUDIENCE PUBLIQUE 20_08_2025', date: '20/08/2025', pdfUrl: 'Audience20082025.pdf' }
      ],
      "RAPPORTS D'AUDIENCES": [
        { title: 'RAPPORT AUDIENCE 18_08_2025', date: '18/08/2025', pdfUrl: 'RapportAudience18082025.pdf' }
      ],
      "DECRETS": [
        { title: 'DÉCRET OFFICIEL 15_08_2025', date: '15/08/2025', pdfUrl: 'Decret15082025.pdf' }
      ]
    };

    const container = document.getElementById('content-container');
    const listView = document.getElementById('list-view');
    const navRight = document.getElementById('nav-right');
    const notifications = document.getElementById('notifications');
    const searchSection = document.getElementById('search-section');
    const searchInput = document.getElementById('search');
    const suggestionsBox = document.getElementById('suggestions');
    const pageTitle = document.getElementById('page-title');
    let currentDoc = null;

    function showNotif(msg) {
      const n = document.createElement('div');
      n.className = 'notif';
      n.textContent = msg;
      notifications.appendChild(n);
      setTimeout(() => n.classList.add('show'), 20);
      setTimeout(() => n.classList.remove('show'), 3000);
      setTimeout(() => n.remove(), 3500);
    }

    function renderList(data) {
      pageTitle.textContent = 'Department Of Justice';
      navRight.innerHTML = ''; // suppr bouton retour
      searchSection.style.display = "block"; // on ré-affiche la recherche
      listView.innerHTML = '';
      Object.keys(data).forEach(cat => {
        const section = document.createElement('div');
        section.className = 'category';
        section.innerHTML = `<h2>${cat}</h2>`;
        data[cat].forEach(doc => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <h3>${doc.title}</h3>
            <p>${doc.date}</p>
            <div class="actions">
              <button class="btn-primary" onclick="openPDF('${doc.pdfUrl}', '${doc.title}')"><i data-lucide="file-text"></i>Voir PDF</button>
              <button class="btn-share" onclick="shareDoc('${doc.title}')"><i data-lucide="share-2"></i>Partager</button>
            </div>`;
          section.appendChild(card);
        });
        listView.appendChild(section);
      });
      lucide.createIcons();
    }

    function openPDF(url, title) {
      currentDoc = title;
      history.replaceState(null, null, `index.html?doc=${encodeURIComponent(title)}`);
      pageTitle.textContent = title;
      navRight.innerHTML = `<button onclick="goHome()"><i data-lucide="arrow-left"></i>Retour</button>`;
      searchSection.style.display = "none"; // cacher la barre de recherche
      listView.innerHTML = `
        <div class="pdf-view">
          <embed src="${url}" type="application/pdf">
        </div>`;
      lucide.createIcons();
    }

    function goHome() {
      history.replaceState(null, null, 'index.html');
      renderList(documentsData);
      setupSearch();
    }

    function shareDoc(title) {
      const shareUrl = `https://xbananous.github.io/departmentofjustice/index.html?doc=${encodeURIComponent(title)}`;
      navigator.clipboard.writeText(shareUrl).then(() => showNotif('Lien copié !'));
    }

    function setupSearch() {
      searchInput.addEventListener('input', () => {
        const q = searchInput.value.toLowerCase();
        suggestionsBox.innerHTML = '';
        if (!q) { suggestionsBox.classList.remove('show'); return; }
        Object.values(documentsData).flat().filter(d => d.title.toLowerCase().includes(q)).forEach(doc => {
          const item = document.createElement('div');
          item.className = 'suggestion-item';
          item.textContent = doc.title;
          item.onclick = () => openPDF(doc.pdfUrl, doc.title);
          suggestionsBox.appendChild(item);
        });
        suggestionsBox.classList.add('show');
      });
      searchInput.addEventListener('blur', () => setTimeout(() => suggestionsBox.classList.remove('show'), 200));
    }

    window.addEventListener('DOMContentLoaded', () => {
      renderList(documentsData);
      setupSearch();
      const params = new URLSearchParams(window.location.search);
      if (params.has('doc')) {
        const doc = Object.values(documentsData).flat().find(d => d.title === params.get('doc'));
        if (doc) openPDF(doc.pdfUrl, doc.title);
      }
    });
  </script>
</body>
</html>
